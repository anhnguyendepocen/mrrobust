---
layout: page
title: "mrrobust examples"
#permalink: /mrrobust-examples/
---
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<style>
/* CSS for Markstat 2.0 using Pandoc 2.0 */
body{padding:14px 28px;}
body, table {font-family: Helvetica, Arial, Sans-serif; font-size: 14px;}
h1, h2, h3, h4 {font-weight: normal; color: #3366cc}
h1 {font-size: 200%;}
h2 {font-size: 150%;}
h3 {font-size: 120%;}
h4 {font-size: 100%; font-weight:bold}
img.center {display:block; margin-left:auto; margin-right:auto}
.small{font-size:8pt;}
a {color: black;}
a:visited {color: #808080;}
a.plain {text-decoration:none;}
a.plain:hover {text-decoration:underline;}
.em {font-weight:bold;}
pre, code {font-family: "lucida console", monospace;}
pre.stata {font-size:13px; line-height:13px;}
pre {padding:8px; border:1px solid #c0c0c0; border-radius:8px; background-color:#fdfdfd;}
code {color:#3366cc; background-color:#fafafa;}
pre code { color:black; background-color:white}
/* Added for Pandoc */
figure > img, div.figure > img {display:block; margin:auto}
figcaption, p.caption {text-align:center; font-weight:bold; color:#3366cc;}
h1.title {text-align:center; margin-bottom:0}
p.author, h2.author {font-style:italic; text-align:center;margin-top:4px;margin-bottom:0}
p.date, h3.date {text-align:center;margin-top:4px; margin-bottom:0}
/* Tables*/
table { margin:auto; border-collapse:collapse; }
table caption { margin-bottom:1ex;}
th, td { padding:4px 6px;}
thead tr:first-child th {border-top:1px solid black; padding-top:6px}
thead tr:last-child  th {padding-bottom:6px}
tbody tr:first-child td {border-top:1px solid black; padding-top:6px}
tbody tr:last-child  td {padding-bottom:6px;}
table tbody:last-child tr:last-child td {border-bottom:1px solid black;}
</style>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Tom Palmer" />
  <meta name="date" content="2018-05-17" />
  <title>Examples from the mrrobust helpfiles</title>
  <style type="text/css">code{white-space: pre;}</style>
</head>
<body>
<div id="header">
<h1 class="title">Examples from the mrrobust helpfiles</h1>
<h2 class="author">Tom Palmer</h2>
<h3 class="date">17 May 2018</h3>
</div>
<h1 id="install-dependencies-and-mrrobust-package">Install dependencies and <code>mrrobust</code> package</h1>
<pre><code>ssc install addplot
ssc install kdens
ssc install moremata
ssc install heterogi
ssc install metan
net install grc1leg, from(http://www.stata.com/users/vwiggins)
net install mrrobust, from(https://raw.github.com/remlapmot/mrrobust/master/) replace</code></pre>
<h1 id="examples">Examples</h1>
<p>Read in example data.</p>
<pre class='stata'>. use https://raw.github.com/remlapmot/mrrobust/master/dodata, clear
</pre>
<p>Select observations (<em>p</em>-value with exposure &lt; 10<sup>-8</sup>).</p>
<pre class='stata'>. gen byte sel1 = (ldlcp2 &lt; 1e-8)
</pre>
<h2 id="mrforest-examples"><code>mrforest</code> examples</h2>
<p>Forest plot of genotype specific IV estimates and IVW and MR-Egger estimates, labelling the genotypes with their RSID.</p>
<pre class='stata'>. mrforest chdbeta chdse ldlcbeta ldlcse if sel1==1, ivid(rsid) ///
>     xlabel(-5,-4,-3,-2,-1,0,1,2,3,4,5)

. gr export mrforest.svg, width(600) replace
(file mrforest.svg written in SVG format)
</pre>
<div class="figure">
<img src="mrforest.svg" alt="Example forest plot of genotype specific IV estimates" class="img-responsive center-block" />
<p class="caption">Example forest plot of genotype specific IV estimates</p>
</div>
<h2 id="mregger-examples"><code>mregger</code> examples</h2>
<p>Using the data provided by Do et al., Nat Gen, 2013 recreate Bowden et al., Gen Epi, 2016, Table 4, LDL-c &quot;All genetic variants&quot; estimates.</p>
<p>IVW (with fixed effect standard errors, i.e. variance of residuals [residual variance] constrained to 1).</p>
<pre class='stata'>. mregger chdbeta ldlcbeta [aw=1/(chdse^2)] if sel1==1, ivw fe

                                                      Number of genotypes = 73
─────────────┬────────────────────────────────────────────────────────────────
             │      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
─────────────┼────────────────────────────────────────────────────────────────
chdbeta      │
    ldlcbeta │   .4815055    .038221    12.60   0.000     .4065938    .5564173
─────────────┴────────────────────────────────────────────────────────────────
</pre>
<p>MR-Egger (with SEs using an unconstrained residual variance [multiplicative random effects]).</p>
<pre class='stata'>. mregger chdbeta ldlcbeta [aw=1/(chdse^2)] if sel1==1

                                                      Number of genotypes = 73
─────────────┬────────────────────────────────────────────────────────────────
             │      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
─────────────┼────────────────────────────────────────────────────────────────
sign(ldlcb~a)│
chdbeta      │
       slope │   .6173131   .1034573     5.97   0.000     .4145405    .8200858
       _cons │  -.0087706   .0054812    -1.60   0.110    -.0195136    .0019723
─────────────┴────────────────────────────────────────────────────────────────
Residual standard error:  1.548
</pre>
<p>MR-Egger reporting I^2_GX statistic and heterogeneity Q-test.</p>
<pre class='stata'>. mregger chdbeta ldlcbeta [aw=1/(chdse^2)] if sel1==1, gxse(ldlcse) heterogi

                                                      Number of genotypes = 73
─────────────┬────────────────────────────────────────────────────────────────
             │      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
─────────────┼────────────────────────────────────────────────────────────────
sign(ldlcb~a)│
chdbeta      │
       slope │   .6173131   .1034573     5.97   0.000     .4145405    .8200858
       _cons │  -.0087706   .0054812    -1.60   0.110    -.0195136    .0019723
─────────────┴────────────────────────────────────────────────────────────────
Residual standard error:  1.548
Heterogeneity/pleiotropy statistics:
──────────┬───────────────────────────────────────────
Statistic │       Estimate        [95% Conf. Interval]
──────────┼───────────────────────────────────────────
        H │          1.5               1.4    1.8     
      I^2 │          58                 46    68      
──────────┴───────────────────────────────────────────
Q-test = 170.11187 d.f. = 71 p-value = 0.0000
I^2_GX statistic:  98.49%
</pre>
<p>MR-Egger using a t-distribution for inference (p-values) &amp; CI limits.</p>
<pre class='stata'>. mregger chdbeta ldlcbeta [aw=1/(chdse^2)] if sel1==1, tdist

                                                      Number of genotypes = 73
─────────────┬────────────────────────────────────────────────────────────────
             │      Coef.   Std. Err.      t    P>|t|     [95% Conf. Interval]
─────────────┼────────────────────────────────────────────────────────────────
sign(ldlcb~a)│
chdbeta      │
       slope │   .6173131   .1034573     5.97   0.000     .4110251    .8236012
       _cons │  -.0087706   .0054812    -1.60   0.114    -.0196998    .0021585
─────────────┴────────────────────────────────────────────────────────────────
Residual standard error:  1.548
</pre>
<p>MR-Egger using the radial formulation.</p>
<pre class='stata'>. mregger chdbeta ldlcbeta [aw=1/(chdse^2)] if sel1==1, radial

                                                      Number of genotypes = 73
─────────────┬────────────────────────────────────────────────────────────────
             │      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
─────────────┼────────────────────────────────────────────────────────────────
radialGD     │
    radialGP │    .642582   .1157871     5.55   0.000     .4156434    .8695205
       _cons │  -.5737301   .3545658    -1.62   0.106    -1.268666    .1212062
─────────────┴────────────────────────────────────────────────────────────────
Residual standard error:  1.547
</pre>
<p>MR-Egger using the radial formulation and reporting heterogeneity (Rucker's) Q-test.</p>
<pre class='stata'>. mregger chdbeta ldlcbeta [aw=1/(chdse^2)] if sel1==1, radial heterogi

                                                      Number of genotypes = 73
─────────────┬────────────────────────────────────────────────────────────────
             │      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
─────────────┼────────────────────────────────────────────────────────────────
radialGD     │
    radialGP │    .642582   .1157871     5.55   0.000     .4156434    .8695205
       _cons │  -.5737301   .3545658    -1.62   0.106    -1.268666    .1212062
─────────────┴────────────────────────────────────────────────────────────────
Residual standard error:  1.547
Heterogeneity/pleiotropy statistics:
──────────┬───────────────────────────────────────────
Statistic │       Estimate        [95% Conf. Interval]
──────────┼───────────────────────────────────────────
        H │          1.5               1.4    1.8     
      I^2 │          58                 46    68      
──────────┴───────────────────────────────────────────
Q-test = 169.97877 d.f. = 71 p-value = 0.0000
</pre>
<h2 id="mreggersimex-examples"><code>mreggersimex</code> examples</h2>
<p>SIMEX suppressing bootstrapped SEs (for speed - remove <code>noboot</code> option to obtain SEs).</p>
<pre class='stata'>. mreggersimex chdbeta ldlcbeta [aw=1/chdse^2] if sel1==1, gxse(ldlcse) ///
>     seed(12345) noboot

                                                      Number of genotypes = 73
                                                    Bootstrap replications = 0
                                                  Simulation replications = 50
─────────────┬────────────────────────────────────────────────────────────────
             │      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
─────────────┼────────────────────────────────────────────────────────────────
       slope │   .6256194          .        .       .            .           .
       _cons │  -.0089987          .        .       .            .           .
─────────────┴────────────────────────────────────────────────────────────────

. gr export mreggersimex-plot.svg, width(600) replace
(file mreggersimex-plot.svg written in SVG format)
</pre>
<div class="figure">
<img src="mreggersimex-plot.svg" alt="SIMEX applied to the MR-Egger model" class="img-responsive center-block" />
<p class="caption">SIMEX applied to the MR-Egger model</p>
</div>
<h2 id="mreggerplot-examples"><code>mreggerplot</code> examples</h2>
<pre class='stata'>. mreggerplot chdbeta chdse ldlcbeta ldlcse if sel1==1

. gr export mreggerplot.svg, width(600) replace
(file mreggerplot.svg written in SVG format)
</pre>
<div class="figure">
<img src="mreggerplot.svg" alt="Scatter plot of the MR-Egger model" class="img-responsive center-block" />
<p class="caption">Scatter plot of the MR-Egger model</p>
</div>
<h2 id="mrmedian-examples"><code>mrmedian</code> examples</h2>
<p>Weighted median estimator.</p>
<pre class='stata'>. mrmedian chdbeta chdse ldlcbeta ldlcse if sel1==1, weighted

                                                      Number of genotypes = 73
                                                           Replications = 1000
─────────────┬────────────────────────────────────────────────────────────────
             │      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
─────────────┼────────────────────────────────────────────────────────────────
        beta │   .4582573   .0624892     7.33   0.000     .3357807    .5807339
─────────────┴────────────────────────────────────────────────────────────────
</pre>
<h2 id="mrmodal-examples"><code>mrmodal</code> examples</h2>
<pre class='stata'>. mrmodalplot chdbeta chdse ldlcbeta ldlcse if sel1==1

                                                      Number of genotypes = 73
                                                           Replications = 1000
                                                                     Phi = .25
─────────────┬────────────────────────────────────────────────────────────────
             │      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
─────────────┼────────────────────────────────────────────────────────────────
        beta │   .4198713   .2237762     1.88   0.061    -.0187219    .8584645
─────────────┴────────────────────────────────────────────────────────────────

                                                      Number of genotypes = 73
                                                           Replications = 1000
                                                                      Phi = .5
─────────────┬────────────────────────────────────────────────────────────────
             │      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
─────────────┼────────────────────────────────────────────────────────────────
        beta │   .4218667   .1950497     2.16   0.031     .0395764    .8041571
─────────────┴────────────────────────────────────────────────────────────────

                                                      Number of genotypes = 73
                                                           Replications = 1000
                                                                       Phi = 1
─────────────┬────────────────────────────────────────────────────────────────
             │      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
─────────────┼────────────────────────────────────────────────────────────────
        beta │   .4917353   .1331011     3.69   0.000     .2308619    .7526086
─────────────┴────────────────────────────────────────────────────────────────

. gr export mrmodalplot.svg, width(600) replace
(file mrmodalplot.svg written in SVG format)
</pre>
<div class="figure">
<img src="mrmodalplot.svg" alt="Densities of the IV estimates using different values of phi" class="img-responsive center-block" />
<p class="caption">Densities of the IV estimates using different values of phi</p>
</div>
<p>Simple mode estimator.</p>
<pre class='stata'>. mrmodal chdbeta chdse ldlcbeta ldlcse if sel1==1

                                                      Number of genotypes = 73
                                                           Replications = 1000
                                                                       Phi = 1
─────────────┬────────────────────────────────────────────────────────────────
             │      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
─────────────┼────────────────────────────────────────────────────────────────
        beta │   .4917353   .1312092     3.75   0.000     .2345699    .7489007
─────────────┴────────────────────────────────────────────────────────────────
</pre>
<p>Weighted mode estimator.</p>
<pre class='stata'>. mrmodal chdbeta chdse ldlcbeta ldlcse if sel1==1, weighted

                                                      Number of genotypes = 73
                                                           Replications = 1000
                                                                       Phi = 1
─────────────┬────────────────────────────────────────────────────────────────
             │      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
─────────────┼────────────────────────────────────────────────────────────────
        beta │   .4789702   .0663424     7.22   0.000     .3489415    .6089989
─────────────┴────────────────────────────────────────────────────────────────
</pre>
<p>Simple mode estimator with NOME assumption.</p>
<pre class='stata'>. mrmodal chdbeta chdse ldlcbeta ldlcse if sel1==1, nome

                                                      Number of genotypes = 73
                                                           Replications = 1000
                                                                       Phi = 1
─────────────┬────────────────────────────────────────────────────────────────
             │      Coef.   Std. Err.      z    P>|z|     [95% Conf. Interval]
─────────────┼────────────────────────────────────────────────────────────────
        beta │   .4917353   .1306138     3.76   0.000      .235737    .7477336
─────────────┴────────────────────────────────────────────────────────────────
</pre>
<h2 id="mrfunnel-examples"><code>mrfunnel</code> examples</h2>
<pre class='stata'>. mrfunnel chdbeta chdse ldlcbeta ldlcse if sel1==1

. gr export mrfunnel.svg, width(600) replace
(file mrfunnel.svg written in SVG format)
</pre>
<div class="figure">
<img src="mrfunnel.svg" alt="Example funnel plot" class="img-responsive center-block" />
<p class="caption">Example funnel plot</p>
</div>
</body>
</html>
